import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
public class dbUpdateOp {
	

	public int update(user_account acc) {
	    int flag = 0;
	    Connection con = dbconnection.getconnection();
	    if ("accId" != null) {
            try {
                updateAccId(acc.getAccId(), acc.getAccId());
            } catch (SQLException e) {
                e.printStackTrace();
            }
        } else if ("userName" != null) {
            try {
                updateUserName(acc.getAccId(), acc.getUserName());
            } catch (SQLException e) {
                e.printStackTrace();
            }
        } else if ("phoneNo" != null) {
            try {
                updatePhoneNo(acc.getAccId(), acc.getPhoneNo());
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
        return flag;
    }
	    

	public boolean updateAccId(int accId, int newAccId) throws SQLException {
	    String query = "UPDATE user_account SET accId=? WHERE accId=?";
	    Connection con = dbconnection.getconnection();
	    try (PreparedStatement ps = con.prepareStatement(query)) {
	        ps.setInt(1, newAccId);
	        ps.setInt(2, accId);
	        int rowsAffected = ps.executeUpdate();
	        return rowsAffected > 0;
	    }
	}

	public boolean updateUserName(int accId, String newUserName) throws SQLException {
	    String query = "UPDATE user_account SET userName=? WHERE accId=?";
	    Connection con = dbconnection.getconnection();
	    try (PreparedStatement ps = con.prepareStatement(query)) {
	        ps.setString(1, newUserName);
	        ps.setInt(2, accId);
	        int rowsAffected = ps.executeUpdate();
	        return rowsAffected > 0;
	    }
	}

	public boolean updatePhoneNo(int accId, String newPhoneNo) throws SQLException {
	    String query = "UPDATE user_account SET phoneNo=? WHERE accId=?";
	    Connection con = dbconnection.getconnection();
	    try (PreparedStatement ps = con.prepareStatement(query)) {
	        ps.setString(1, newPhoneNo);
	        ps.setInt(2, accId);
	        int rowsAffected = ps.executeUpdate();
	        return rowsAffected > 0;
	    }
	}

	public boolean updateAccountBalance(int accId, int newAccBal) throws SQLException {
	    String query = "UPDATE user_account SET accBal=? WHERE acc_no=?";
	    Connection con = dbconnection.getconnection();
	    try (PreparedStatement ps = con.prepareStatement(query)) {
	        ps.setInt(1, newAccBal);
	        ps.setInt(2, accId);
	        int rowsAffected = ps.executeUpdate();
	        return rowsAffected > 0;
	    }
	}

	public boolean updatePassword(int accId, int newPassword) throws SQLException {
	    String query = "UPDATE user_account SET password=? WHERE accId=?";
	    Connection con = dbconnection.getconnection();
	    try (PreparedStatement ps = con.prepareStatement(query)) {
	        ps.setInt(1, newPassword);
	        ps.setInt(2, accId);
	        int rowsAffected = ps.executeUpdate();
	        return rowsAffected > 0;
	    }
	}

}
